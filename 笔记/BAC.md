<!--
 * @Author: Suez_kip 287140262@qq.com
 * @Date: 2023-09-04 10:06:16
 * @LastEditTime: 2023-09-04 11:43:15
 * @LastEditors: Suez_kip
 * @Description: 
-->
# Break Access Control

难点：

- 语义：非特殊输入，无法用数据消毒预防；
- 复杂性：与业务逻辑、语义深度耦合；
  - web应用程序不再适应DAC、RBAC或MAC等简单的访问控制模型，细粒度和程序逻辑深度耦合；
  - 未经训练的开发人员可能会忽略其实现中的一些潜在假设；
  - 厂商的不遵循；
  - Orange CERT等使用很容易被利用的短随机令牌；
- 部分控制策略甚至是动态的；
  - web应用程序中的访问控制策略是不断更新的，留下可利用的信息，如资源标识符、URL模式等。
  - 旧的被弃用的功能如果不引起注意，就会留下过时的api和孤立的页面，而新添加的功能在没有经过彻底测试的情况下可能容易受到访问控制绕过的攻击。
- 系统支持缺失
  - 工具支持应该更多地在预部署阶段作为主动的方式
  - web框架目前大多遵循MVC[30]、MVP[12]或MVVM[18]等软件架构模式，并没有对访问控制进行特殊的处理；
  - 访问控制测试作为中间步骤嵌入到其他功能测试中，导致阻碍其他测试，本身也容易遗漏；

## web架构

- MVC模式：
![图 1](../images2/33e695a8800707a6aadaee2cb80948be6f80cd011aee29cb876469a880fdb350.png)  

  - 视图（View）：用户界面。
  - 控制器（Controller）：业务逻辑
  - 模型（Model）：数据保存
  - View 传送指令到 Controller
  - Controller 完成业务逻辑后，要求 Model 改变状态
  - Model 将新的数据发送到 View，用户得到反馈

![图 2](../images2/d4fd36eb9b828f138aa47ba08a292a976ee1ef0294f8fcd122e03aa5e0a43896.png)  

- MVP 模式：将 Controller 改名为 Presenter，同时改变了通信方向。
![图 3](../images2/b95a0f984ea77571d122634e6604c9175a5500fffe0ba543c07e83ff90c9340d.png)  

  - 各部分之间的通信，都是双向的。
  - View 与 Model 不发生联系，都通过 Presenter 传递。
  - View 非常薄，不部署任何业务逻辑，称为"被动视图"（Passive View），即没有任何主动性，而 Presenter非常厚，所有逻辑都部署在那里；

- MVVM 模式：MVVM 模式将 Presenter 改名为 ViewModel。
![图 4](../images2/c107ffed6d9a5713377f8d3c3326f6209d5f7a916f1e2122b17128b3916c03e5.png)  

  - 唯一的区别是，它采用双向绑定（data-binding）：View的变动，自动反映在 ViewModel，反之亦然。Angular 和 Ember 都采用这种模式；

## 访问控制设计

### 系统设计与实现

#### 框架支持

领域特定语言(DSL)接口和数据模型以强制应用访问控制策略

#### 数据库支持

DBMS层的一个方向是利用现有的数据库特性，设计特殊的数据库和中间件，在内部实施访问控制

#### 语言支持

实施信息流控制，这样数据流就必须遵守数据对象上的安全断言/属性。这种强化可以通过利用编程语言的概念和技术来实现，比如细化类型、逻辑证明、静态信息流分析等。

#### 开发环境支持

提醒开发者开发环境中潜在的访问控制漏洞，以实现高交互性低侵入性；

### 软件分析和测试

#### 异常值检测

根据Clark-Wilson模型，访问控制模型可以表示为一个认证主体(subject)、一组程序(program)和一组待操作数据项(object)之间的关系，即访问控制三元组(access control triple)。通过检查该部分的偏差来达到BAC的分析；

#### 自动化检测

以前的许多访问控制策略测试工作都假定存在一个专用组件来控制对资源的访问，该组件通常称为策略决策点(PDP)。这些策略通常是由管理部门用XACML编写的，这使得它更像是一个错误配置问题，而不是代码逻辑错误。

#### 形式化方法

使用严格的数学模型来确保系统的正确行为

### 运行时检测

pass
